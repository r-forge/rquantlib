%% add 'handout' option for handouts, and pgfpages for 2-on-1
\documentclass[smaller,compress]{beamer}   
%\usepackage{pgfpages}
%\pgfpagesuselayout{2 on 1}[letterpaper,border shrink=5mm]
%\pgfpagesuselayout{4 on 1}[letterpaper,border shrink=5mm]
%\pgfpagesuselayout{2 on 1}[a4,border shrink=5mm]


\include{beamer_setup}  %% has all definitions etc


\title[RQuantLib]{RQuantLib: Interfacing QuantLib from R}  %% better title welcome...
\subtitle{\textsl{R / Finance 2010 Presentation}}
\subject{R / Finance 2010 Presentation}
\author[Eddelbuettel \and Nguyen]{Dirk Eddelbuettel\inst{1} \and Khanh Nguyen\inst{2}}
\institute[Debian and UMASS]{
  \inst{1}%
  Debian Project
  \and 
  \inst{2}
  UMASS at Boston
}
\date[R / Finance 2010]{R / Finance 2010 \\ April 18 and 19, 2010 \\ Chicago, IL, USA}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\section{Introduction}
\begin{frame}
  \frametitle{Overview}
  \framesubtitle{Presentation details}
  \begin{itemize}
  \item Brief overview of QuantLib
    \begin{itemize}
    \item History, about to release 1.0 after eight long years
    \item Luigi's design document draft, mention rigorous design, unit
      tests, boost, 'grown up C++'
    \item Maybe mention different language bindings
    \item Maybe mention liberal QL license; R / RQuantLib with GPL somewhat
      tighter but in spirit of R community
    \end{itemize}
  \item RQuantLib maybe chronologically
    \begin{itemize}
    \item Equity options part
    \item Simple calendaring
    \item Mention the older fixed income / curve stuff without dwelling on it
    \end{itemize}
  \item Fixed Income / GSoC 2009
    \begin{itemize}
    \item Khanh ....
    \item More Khanh ...
    \end{itemize}
  \item Total of somewhere between 20 and 30 pages
  \item Finish with Outlook / Agenda / Areas not yet covered
  \end{itemize}
\end{frame}

\begin{frame}[fragile]  % fragile important when lstlisting used
  \frametitle{We can do code}
  \framesubtitle{Thanks to lstlisting}

\lstset{language=C++,basicstyle=\tiny}
\begin{lstlisting}
#include <Rcpp.hpp>

RcppExport SEXP dd_rcpp(SEXP v) {
  SEXP  rl = R_NilValue;             // Use this when nothing is returned

  RcppVector<int> vec(v);            // vec parameter viewed as vector of doubles
  int n = vec.size(), i = 0;

  for (int a = 0; a < 9; a++)
    for (int b = 0; b < 9; b++)
      for (int c = 0; c < 9; c++)
        for (int d = 0; d < 9; d++)
          vec(i++) = a*b - c*d;

  RcppResultSet rs;                  // Build result set returned as list to R
  rs.add("vec", vec);                // vec as named element with name 'vec'
  rl = rs.getReturnList();           // Get the list to be returned to R.

  return rl;
}
\end{lstlisting}


\end{frame}

\begin{frame}
	\frametitle{Fixed Income in RQuantLib}
	\framesubtitle{Quick overview}
	\begin{itemize}
		\item Fixed Income functions are added during the summer of 2009 as part of the Google Summer of 	Code program. \pause
		\item The functions aim to support two primary tasks: pricing and curve fitting. 		
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Fixed Income in RQuantLib}
	\framesubtitle{Primary tasks: Curve fitting}
	\begin{itemize}
		\item Curve fitting functions
			\begin{itemize}
				\item Curve fitting functions return a DiscountCurve object that contains a two column dates/zeroRates data frame.
				\item The returned DiscountCurve object are used as inputs for pricing functions. 
				\item Currently, there are two curve fitting functions
					\begin{itemize}
						\item DiscountCurve - constructs the spot term structure of interest rates based on input market data including the settltment date, deposit rates, future prices, FRA rates or swap rates in various combination. \pause
						\item FittedBondCurve - fits a term structure to a set of bonds using three different fitting methods (ExponentialSplinesFitting, SimplePolynomialFitting, NelsonSiegelFitting).
					\end{itemize}
			\end{itemize}
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Fixed Income in RQuantLib}
	\framesubtitle{Primary tasks: Bond pricing}
	\begin{itemize}
		\item Bond pricing functions return clean price, dirty price, NPV and cash flow of a bond
		\item Currently, the following bonds are supported
			\begin{itemize}
				\item Zero Coupon Bond
				\item Fixed Rate Bond
				\item Floating Rate Bond
				\item Convertible Zero Coupon Bond
				\item Convertible Fixed Rate Bond												
				\item Convertible Floating Rate Bond
				\item Callable Bond
			\end{itemize}
	\end{itemize}
\end{frame}

\begin{frame}[fragile]
	\frametitle{Fixed Income in RQuantLib}
	\framesubtitle{Examples: Curve fitting}
	\begin{itemize}
		\item DiscountCurve example:		

			\lstset{language=R,basicstyle=\tiny}
				\begin{lstlisting}		
params <- list(tradeDate=as.Date('2004-09-20'),
               settleDate=as.Date('2004-09-22'),
               interpWhat="discount",
               interpHow="loglinear")
tsQuotes <- list(d1w = 0.0382,
                 d1m = 0.0372,
                 d3m = 0.0363,
                 d6m = 0.0353,
                 d9m = 0.0348,
                 d1y = 0.0345,
                 fut2=96.7875,
                 fut3=96.9875,
                 fut4=96.6875,
                 fut5=96.4875,
                 fut7=96.2875,
                 s2y = 0.037125,
                 s3y = 0.0398,
                 s5y = 0.0443,
                 s10y = 0.05165,
                 s15y = 0.055175)
curves <- DiscountCurve(params, tsQuotes)		
\end{lstlisting}
\end{itemize}
\end{frame}



\begin{frame}[fragile]
	\frametitle{Fixed Income in RQuantLib}
	\framesubtitle{Examples: Curve fitting}
	\begin{itemize}
		\item FittedBondCurve example:
			\lstset{language=R,basicstyle=\tiny}
				\begin{lstlisting}
lengths <- c(2,4,6,8,10,12,14,16,18,20,22,24,26,28,30)
coupons <- c(0.0200, 0.0225, 0.0250, 0.0275, 0.0300,
         	 0.0325, 0.0350, 0.0375, 0.0400, 0.0425,
             0.0450, 0.0475, 0.0500, 0.0525, 0.0550 )
marketQuotes <- rep(100, length(lengths))
dateparams <- list(settlementDays=0, period="Annual", 
                             dayCounter="ActualActual", 
                             businessDayConvention ="Unadjusted")
curveparams <- list(method="ExponentialSplinesFitting", 
                                origDate = Sys.Date())
curve <- FittedBondCurve(curveparams, lengths, coupons, marketQuotes, dateparams)
library(zoo)
z <- zoo(curve$table$zeroRates, order.by=curve$table$date)
plot(z)
				\end{lstlisting}		

\end{itemize}
\end{frame}

\begin{frame}[fragile]
	\frametitle{Fixed Income in RQuantLib}
	\framesubtitle{Examples: Bond pricing}	
			\lstset{language=R,basicstyle=\tiny}
				\begin{lstlisting}
fixingDays <- 3
settlementDays <- 3

settlementDate <- as.Date('2008-09-18')
todaysDate <- settlementDate - fixingDays

#begin to set up bond discounting term structure
lengths <- c(5, 6, 7, 16, 48)
coupons <- c(0.02375, 0.04625, 0.03125, 0.04000, 0.04500)
marketQuotes <- c(100.390625, 106.21875, 100.59375, 101.6875, 102.140625)
dateparams <- list(settlementDays=settlementDays,
                   period=2, 
                   dayCounter="ActualActual", 
                   businessDayConvention ="Unadjusted")
curveparams <- list(method="ExponentialSplinesFitting", 
                    origDate=todaysDate)
bondDsctTsr <- FittedBondCurve(curveparams,
                               lengths,
                               coupons,
                               marketQuotes,
                               dateparams)
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
	\frametitle{Fixed Income in RQuantLib}
	\framesubtitle{Examples: Bond pricing}	
			\lstset{language=R,basicstyle=\tiny}
				\begin{lstlisting}
#begin to set up swap term structure
swp.tsr.params <- list(tradeDate=todaysDate,
                        settleDate=todaysDate+2,
                        dt=0.25,
                        interpWhat="discount",
                        interpHow="loglinear")
market.quotes <- list(d1w=0.043375,
                      d1m=0.031875,
                      d3m=0.0320375,
                      d6m=0.03385,
                      d9m=0.0338125,
                      d1y=0.0335125,                      
                      s2y=0.0295,
                      s3y=0.0323,
                      s5y=0.0359,
                      s10y=0.0412,
                      s15y=0.0433)
depoSwpTsr <- DiscountCurve(swp.tsr.params, market.quotes)
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
	\frametitle{Fixed Income in RQuantLib}
	\framesubtitle{Examples: Bond pricing}	
			\lstset{language=R,basicstyle=\tiny}
				\begin{lstlisting}
#Zero-Coupon Bond
zc.bond.param <- list(maturityDate=as.Date('2013-08-15'), issueDate=as.Date('2003-08-15'), redemption=116.92)

zc.bond.dateparam <- list(refDate=todaysDate, settlementDays=settlementDays, businessDayConvention='Following')

ZeroCouponBond(zc.bond.param, bondDsctTsr, zc.bond.dateparam)

#Fixed-Coupon Bond
fixed.bond.param <- list(maturityDate=as.Date('2017-05-15'), issueDate=as.Date('2007-05-15'),redemption=100, effectiveDate=as.Date('2007-05-15'))

fixed.bond.dateparam <- list(settlementDays=settlementDays, dayCounter='ActualActual', period='Semiannual', businessDayConvention='Unadjusted', terminationDateConvention='Unadjusted', dateGeneration='Backward', endOfMonth=0)

fixed.bond.coupon <- c(0.045)

FixedRateBond(fixed.bond.param,
              fixed.bond.coupon,
              bondDsctTsr,
              fixed.bond.dateparam)
\end{lstlisting}
\end{frame}



\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
